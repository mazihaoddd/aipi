## YOLOv4笔记
这项工作的主要目标是在生产系统中设计一个有快速运行速度且准确的目标检测器，并优化并行计算。使用一个1080 Ti或2080 Ti GPU即可训练，同时作者也验证了BoS和BoF对训练的影响，还优化了方法适用于单GPU训练。
![QQ截图20230826180609](C:\Users\hp1\Desktop\QQ截图20230826180609.png)
**检测器的要求：**	  
	更高的输入网络大小（分辨率）——用于检测多个小大小的物体
	更多的层——更高的接受域以覆盖增加的输入网络大小	
	更多的参数——模型更大的能力来检测单一图像中多个不同大小的物体
**不同规模感受野的影响：**    
对象级大小-允许查看整个对象  
网络级大小-允许查看对象周围的上下文
超出网络大小-增加图像点和最终激活之间的连接数

**一个带有bag-of-specials集成的增强型架构**：作者尝试了多种骨干架构， 如ResNeXt50 、EfficientNet-B3和Darknet-53。表现最好的架构是对Darknet-53的修改，采用跨阶段部分连接（CSPNet），以Mish激活函数作为骨干。对于颈部，他们使用了YOLOv3-spp中的修改版空间金字塔集合（SPP）和YOLOv3中的多尺度预测，但用修改版的路径聚合网络（PANet）代替FPN，以及修改的空间注意模块（SAM）。最后，对于检测头，他们使用YOLOv3中的锚。因此，该模型被称为CSPDarknet53-PANet-SPP。添加到Darknet-53中的跨阶段部分连接（CSP）有助于减少模型的计算量，同时保持相同的精度。与YOLOv3-spp中一样，SPP块在不影响推理速度的情况下增加了感受野。修改后的PANet版本将特征串联起来，而不是像原PANet论文中那样将其添加。

作者未使用跨gpu批处理归一化（CGBN或SyncBN)或昂贵的专用设备。使得在传统的图形处理器上可以再现结果。

**bag-of-freebies的高级训练方法**：除了常规的增强，如随机亮度、对比度、缩放、裁剪、翻转和旋转，作者还实现了马赛克增强，将四张图像合并为一张，允许检测其通常背景之外的物体，同时也减少了对大批量正常化的小批量的需求。对于正则化， 他们使用了DropBlock ， 作为Dropout的替代品，但用于卷积神经网络以及类标签平滑。对于检测器，他们增加了CIoU 损失和Cross mini-bath normalization (CmBN)，用于收集整个批次的统计数据，而不是像常规批次归一化中的单个小批次。


Mosaic允许检测其正常上下文之外的对象。此外，批归一化计算每一层上4个不同图像的激活统计信息。这大大减少了对大型小批量处理的需求。

**自我对抗性训练（SAT）：**为了使模型对扰动更加稳健，对输入的图像进行对抗性攻击，以创造一个欺骗性，即ground truth不在图像中，但保持原始标签以检测正确的对象。

**用遗传算法进行超参数优化**：为了找到用于训练的最佳超参数，他们在前10%的时期使用遗传算法，并使用余弦退火调度器来改变训练期间的学习率。它开始缓慢地降低学习率，然后在训练过程的一半时快速降低，最后略微降低。